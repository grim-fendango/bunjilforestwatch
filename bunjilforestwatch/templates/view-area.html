{% extends "base.html" %} {% block head %}
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<style type="text/css">
html {
	height: 100%
}

body {
	height: 100%;
	margin: 10;
	padding: 10
}

#map-canvas {
	height: 100%
}
</style>
<style type="text/css">

/** For Bootstrap and Google Maps Info window styles problem - Fix from http://stackoverflow.com/questions/16708324/google-maps-infowindow-close-button-hidden **/
img[src*="gstatic.com/"],img[src*="googleapis.com/"] {
	max-width: none;
}
</style>

<link href="/static/css/jquery.nouislider.css" rel="stylesheet">


<script type="text/javascript"
	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDxcijg13r2SNlryEcmi_XXxZ9sO4rpr8I&sensor=false&v=3&libraries=geometry,visualization,drawing"> </script>
<script type="text/javascript" src="/static/js/draggable-object.js"></script>
<script type="text/javascript" src="/static/js/custom-tile-overlay.js"></script>
<script type="text/javascript" src="/static/js/yaml/YamlInline.js"></script>
<script type="text/javascript" src="/static/js/yaml/YamlParser.js"></script>
<script type="text/javascript" src="/static/js/yaml/Yaml.js"></script>
<script type="text/javascript" src="/static/js/landsat-grid.js"></script>
<script type="text/javascript" src="/static/js/polygon-outliner.js"></script>
<script type="text/javascript" src="/static/js/drawing-tools.js"></script>
<script type="text/javascript" src="/static/js/bootbox.min.js"></script>
<script type="text/javascript" src="/static/js/jquery.nouislider.min.js"></script>

        <script>
             // On document ready, initialize noUiSlider.
            $(function(){

                $('.slider').noUiSlider({
                    start: [ 100 ],
                    range: {
                        'min': 0,
                        'max': 100
                    },
                    connect:"lower" 
                });
            });

        </script>

<script>

var instructions_str =  
    "Earth Engine is now calculating which Landsat cells overlap your new area. This can take a few minutes. <br />" +
    "Then it will display the cells as rectangles overlapping your area. <br />" + 
    //"You can also hide or show them with the 'Landsat Grid' togle <br />" +
    "Select the cells you wish to include in reports by clicking on them. <br />" +
    "Click again to unselect the cell and remove it from reports. <br /><br>" + 
    "Each cell generates more work for reviewers every 8 days. <br />Only select cells that overlap critical areas you wish to monitor.";

var map;
var mapobj; //returned by last call to EE image overlay.
var satellite = 'l8'
var algorithm = 'rgb'; // ndvi 
var latest = 0;  //latest - 0
var overlayMaps = [];

function initialize() {
    var map_center = new google.maps.LatLng({{area.map_center}});
    var mapOptions = {
		zoom: {{ area.map_zoom }},
		center: map_center,    
		mapTypeId: google.maps.MapTypeId.HYBRID,
		panControl:true,
		zoomControl:true,
		mapTypeControl:true,
		scaleControl:true,
		streetViewControl:false,
		overviewMapControl:false,
		rotateControl:false,
		clickable: true
	}
 
    map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
  
  	//wait for map to load so bounds are known before setting up landsat grid.
  	//now activated by the checkbox.
  	
  	google.maps.event.addListener(map, 'bounds_changed', function() {
  		
  		if(gridInitialised == true)
  		{
  		    requestLandsatGrid(map, true, true, cellarray ); //map, showlayer, clickable, cells
  		}
  		$(landsatgrid_panel).empty();
		htmlString = "<p><font-size:50%;color:blue strong>zoom:</strong> " + map.getZoom() + "</p>";
		htmlString += "<p>lat: " + map.getCenter().lat().toFixed(3) + ", lng: " + map.getCenter().lng().toFixed(3) + "<br></p>";
		//htmlString +=  this.get("Description");
		//console.log( htmlString);
		$(landsatgrid_panel).html(htmlString);
    });

   	google.maps.event.addListener(map, 'zoom', function() { 
	         	console.log("zoom to:", map.zoom());
	});
 
    google.maps.event.addListener(map, 'idle', function() {
        //This is needed so the fusion tables query works
        var map_center = map.getCenter()
        if (map_center.lng() < -180) { 
            map.setCenter(new google.maps.LatLng(map_center.lat(), map_center.lng()+360));
        }
        if (map_center.lng() > 180) { 
            map_center.lng() -= 360;
            map.setCenter(map_center);
        }
     });

    //Collect the Boundary coordinates from the area and convert to a Google Maps object.
    
    var latlngs = [];
    
    {% for j in area.coordinates %}
    	latlngs.push(new google.maps.LatLng({{j}}))
    {% endfor %}
     
    areaBoundary = new google.maps.Polygon({
                paths: latlngs,
                strokeColor: '#FFFF00',
                strokeOpacity: 0.5,
                strokeWeight: 2,
                fillColor: '#000000',
                fillOpacity: 0.15
    });
    
    
    areaBoundary.setMap(map);
    //addToMap(map, areaBoundary, "boundary")

	/*  if AOI is new, then need to ask earthengine to calculate what cells overlap the areaAOI. 
	 *  This is done here the first time the area is viewed. But could be part of constructor for AreaOfInterest.
	 *  Old method was a big rectangle. 
	 *         var latlng_bounds = {'max_lat': {{area.max_latlon.lat}}, 'min_lat': {{area.min_latlon.lat}}, 'max_lon': {{area.max_latlon.lon}}, 'min_lon': {{area.min_latlon.lon}}};
	 *         cellarray =         {'max_path':{{area.max_path}},       'min_path': {{area.min_path}},      'max_row': {{area.max_row}},        'min_row': {{area.min_row}}};
	 *  New method calculates intersections so returns only overlapping cells.
	 */    
    cellarray = {{celllist}};    //cellarray = jQuery.parseJSON({{celllist}});
    
    console.log('Init:Cellarray from view-area handler: ', cellarray);
    if(cellarray.length == 0){ // Then fetch the overlapping cells from server..
        console.log("Init: Fetching Overlapping Cells for Area");
        var url = "{{ area|area_url }}"  + '/' + 'getcells';
        console.log( "url: ", url);
        $("#observations_panel").collapse('show');
        $('#observations_panel').empty();
        $('#observations_panel').append("Calculating Landsat Cells ...");
        $('#observations_panel').append('<img src="/static/img/ajax-loader.gif" class="ajax-loader"/>');
        bootbox.dialog({
            message: instructions_str,
            title: "Next Steps",
            closeButton: true,
            buttons: {
              success: {
              label: "Continue ...",
              className: "btn-success",
              callback: function() {
                  bootbox.hideAll();
              }
            }
          }
        })
        
        $.get(url).done(function(data) {
        	cellarray = jQuery.parseJSON(data);
            
            console.log('Init:Cellarray from ajax handler: ', cellarray);
            $('#observations_panel').empty();
            $('#observations_panel').append("Area has " + cellarray.length + " cells. " );
                requestLandsatGrid(map, true, true, cellarray); //map, showlayer, clickable, cells
                $('.layer').prop('checked',true);
        }).error(function( jqxhr, textStatus, error ) {
            var err = textStatus + ', ' + error;
            console.log( "GetCells Failed: " + err);
            $('#observations_panel').empty();
            $('#observations_panel').append("<p>GetCells Failed: " + err + "</p>"); 
        });
    } //get cells    
    else
   	{
        //server passed an existing cellarray - just display it (need to highlight monitored cells)
    	requestLandsatGrid(map, true, true, cellarray); //map, showlayer, clickable, cells
   	}
    
    // Fetch Overlay Image of Latest Landsat
    $('#get_overlay_btn').click(function(){
    	var httpget_url = httpgetActionUrl("overlay")
        console.log( "urls", httpget_url);
       $("#observations_panel").collapse('show');
	 	   $('#observations_panel').empty();
	 	   $('#observations_panel').append("Getting Sat Data...");
 		   $('#observations_panel').append('<img src="/static/img/ajax-loader.gif" class="ajax-loader"/>');
	 	   $.get(httpget_url).done(function(data) {
	         $('#observations_panel').empty();
	 	    mapobj = jQuery.parseJSON(data);
	 	    if (mapobj)
	 	    	{
	 	    	  $('#observations_panel').append("Captured: ", mapobj.date_acquired, "\n", mapobj.id, "\nPath: ", mapobj.path, ", Row: ", mapobj.row);
	 	    	  createImageOverlay(true, mapobj.mapid,  mapobj.token, mapobj.date_acquired);
	 	    	}
	 	    else
	 	    	{
	 	       	         $('#observations_panel').append("No Sat Data");
	 	    	}
	        }).error(function( jqxhr, textStatus, error ) {
	            var err = textStatus + ', ' + error;
	            console.log( "Request Failed: " + err);
	            $('#observations_panel').empty();
	            $('#observations_panel').append("<p>Failed: " + err + "</p>"); 
	 	});
    }); //get_overlay_btn.click

    //download and image - This does not work yet.  		    
    $('#get_download_btn').click(function(){ 
            var pathname = window.location.pathname + '/download/' + satellite + '/' + algorithm + '/' + latest;
            //window.history.replaceState('string', 'load image', pathname);
	 		$("#observations_panel").collapse('show');
	 		$('#observations_panel').empty();
	 		$('#observations_panel').append("Getting Download ...");//animated gif from http://www.ajaxload.info/
 			$('#observations_panel').append('<img src="/static/img/ajax-loader.gif" class="ajax-loader"/>');
	 		$.get(pathname) //, { name: "not used", time: "notused" }
	 		.done(function(path){
	 			$('#observations_panel').empty();
	 			$('#observations_panel').append(path); 
	 			window.open(path);
	 		})
	 		.error(function( jqxhr, textStatus, error ) {
	 	          var err = textStatus + ', ' + error;
	 	          console.log( "Download Failed: " + err);
		 		  $('#observations_panel').empty();
		 		  $('#observations_panel').append("<p color:red>Sorry Download is Broken! " + err + "</p>"); 
	 	    });
   	});

 	//Checkbox to show/hide overlays  		
   	$('.layer').click(function(){
   			var layerID = parseInt($(this).attr('id'));
   		    if(layerID === 0) //LANDSAT grid 
   		    {
   		        if($(this).is(':checked')){
   		    	  requestLandsatGrid(map, true, true,  cellarray); //map, showlayer, clickable, cells
   		    	}
   		    	else {
                    requestLandsatGrid(map, false, true, null); //map, showlayer, clickable, cells
                    //TODO put inside above funciton.
	    		}
            }
   		    
            if(layerID === 1) //Drawing Tools
            {
                if($(this).is(':checked')){
                    drawingManager = createDrawingManager(map);
                    google.maps.event.addListener(drawingManager, 'overlaycomplete', function(event) {
                        //if (event.type == google.maps.drawing.OverlayType.CIRCLE) {
                        //  var radius = event.overlay.getRadius();
                        href = "{{ "user"|url(user.name) }}/journal/Observations for {{area.name}}/new/";
                        if (mapobj != null)
                        {
                            window.location.href = href + mapobj.id;
                        }
                        else
                        {
                            window.location.href = href + "Observation"; // no overlay for this observation
                        }
                    });
                }
                else {
                    // TODO: Hide Drawing Tools                	
                    // createImageOverlay(false,0,0,0);
                    // var overlayMap = new google.maps.ImageMapType(overlayMaps[layerID]);
                    // map.overlayMapTypes.setAt(layerID, overlayMap);
                }
            }
            if(layerID === 2) //FORMA grid 
            {
                if($(this).is(':checked')){
                  //getFORMA(map, true); //map, showlayer,
                  
                    $("#layers_panel").collapse('show');
                    $('#sliders_array').append("<div class=\"slider\" id=\"slider1\">.</div>");
                    $('#slider1').noUiSlider({
                        start: [ 100 ],
                        range: {
                            'min': 0,
                            'max': 100
                        },
                        connect:"lower"
                    });
                    $('#slider1').show()
                }
                else {
                  //getFORMA(map, false); //map, hide
                    //removeLandsatGrid();  //TODO put inside above funciton.
                    //$("#layers_panel").collapse('hide');
                }
            }
                
 	});
   		
 	//Change the text in the drop-down button when a selection is changed.
   	$('#algorithm-visual').click(function(e){
           $("#algorithm:first-child").text("RGB");
           algorithm = 'rgb';
   		   e.preventDefault();
   		});
        $('#algorithm-ndvi').click(function(e){
           $("#algorithm:first-child").text("NDVI");
           algorithm = 'ndvi';
           e.preventDefault();
        });
        $('#algorithm-change').click(function(e){
           $("#algorithm:first-child").text("Change");
           algorithm = 'change';
           e.preventDefault();
        });
        
        $('#latest').click(function(e){
            $("#latest:first-child").text("Latest  ");
            latest = 0;
            e.preventDefault();
        });
        $('#latest-1').click(function(e){
            $("#latest:first-child").text("Latest-1");
            latest = 1;
            e.preventDefault();
        });
        $('#latest-2').click(function(e){
            $("#latest:first-child").text("Latest-2");
            latest = 2;
            e.preventDefault();
        });
        $('#latest-3').click(function(e){
            $("#latest:first-child").text("Latest-3");
            latest = 3;
            e.preventDefault();
        });
        
        $('#satellite').click(function(e){
            $("#satellite:first-child").text("L8");
            satellite = 'l8';
            e.preventDefault();
        });
        $('#satellite-l7').click(function(e){
            $("#satellite:first-child").text("L7");
            satellite = 'l7';
            e.preventDefault();
        });
        $('#satellite-both').click(function(e){
            $("#satellite:first-child").text("Both");
            satellite = 'l78';
            e.preventDefault();
        });
        
   		$(window).resize(function () {
   				//<!--resize tip from https://github.com/twitter/bootstrap/issues/2475 -->
     	    var h = $(window).height(),
	    	        offsetTop = 60; // Calculate the top offset
	    	    $('#map-canvas').css('height', (h - offsetTop));
	    	}).resize();
        // now map is drawn is a good time to set up the Instructions Popover.
        var instructions_content = 
          "<p>" +
          "Select Landsat Cells to monitor.<br>" + 
          "Click to highlight the cells that you wish to monitor. Click again to remove from monitoring.<br>" + 
          "Each selected cell will add to the number of observation tasks for this area.<br>" + 
          "Selected cells are regularly checked for new data.<br>" + 
          "To hide the layer of cells, uncheck 'Landsat Grid'.<br>" + 
          "You can also view the most recent observation for any cells with the <b>View</b> button and Image settings.</li>" 
      
        $('#instructions').popover({ 
            html : true, 
            animation: true,
            trigger: 'hover',
            container: 'body',
            title: 'Select and view Cells',  
            placement: 'bottom',
            content: instructions_content
            });
        $('#instructions').popover();
        
    

   		
};//initialize
google.maps.event.addDomListener(window, 'load', initialize); 


function addToMap(map, overlay, overlay_id)
{
    overlay.show();
    overlay.name = overlay_id;
    overlayMaps.push(overlay);
    slider_id = "#slider" + overlay_id; 
    //$("#layers_panel").collapse('show');
    $('#sliders_array').append("<div class=\"slider\" id=\"" + overlay_id + "\"></div>");
    $(slider_id).noUiSlider({
        start: [ 100 ],
        range: {
            'min': 0,
            'max': 100
        },
        connect:"lower"
    });
    $('#overlay_id').show();
}

function removeFromMap(map, overlay_id)
{
    overlay = overlayMaps.pop(); //needs to be a splice not a pop.
    overlay.hide();
    //hide slider
}

function createImageOverlay(show, mapid,  token, slider_name)
{
    if(show == true)
    {
        //CREATE LAYER WITH SLIDER based on NZ Topo maps example.
        overlay = new CustomTileOverlay(map, initialOpacity, mapid, token);
    
        google.maps.event.addListener(map, 'tilesloaded', function () {
            overlay.deleteHiddenTiles(map.getZoom());
        });
        addToMap(map, overlay, slider_name.substring(5))
        
        // Add opacity control and set initial value
        
        //createOpacityControl(map, initialOpacity, slider_name.substring(5));    
    }
    else 
    {
        removeFromMap(map, slider_name.substring(5) );
    }
}

function setActionUrl(action)
{
   // action can be 'overlay' or 'download' strip the old action and append the new action.
   var url = window.location.href
   if (url.indexOf("/overlay") !=-1) {
      url = url.substring(0, url.indexOf("/overlay")); //strip the last action.
   }
   if (url.indexOf("/download") !=-1) {
       url = url.substring(0, url.indexOf("/download")); //strip the last action.
   }
   if (url.indexOf("/action") !=-1) {
          url = url.substring(0, url.indexOf("/action")); //strip the last action.
    }

   url = url + '/action/' + action + '/' + satellite + '/' + algorithm + '/' + latest;
   
   //Not working so disable the final bit.
   return url
};

function ajaxActionUrl(action)
{
   // action can be 'overlay' or 'download'.
   url = "{{ area|area_url }}"  + '/' + action + '/' + satellite + '/' + algorithm + '/' + latest;
   return url
};


function httpgetActionUrl(action)
{
   // action/<action> can be 'overlay' or 'download'.
   //satellite is 'l8' or 'l7' but should change to collection name.
   var url = "{{ area|area_url }}"  + '/action/' + action + '/' + satellite + '/' + algorithm + '/' + latest ;
   if((selectedPath != -1) && (selectedRow != -1))
   {
       url  += "/" + selectedPath + "/" + selectedRow;
   }
   return url
};


function jsonStringifySelectedCell()
{
   var ul=[selectedLAT_UL, selectedLON_UL];
   var ll=[selectedLAT_LL, selectedLON_LL];
   var lr=[selectedLAT_LR, selectedLON_LR];
   var ur=[selectedLAT_UR, selectedLON_UR];
   
   var cell_coords = Array();
   
   cell_coords.push(ul);
   cell_coords.push(ll);
   cell_coords.push(lr);
   cell_coords.push(ur);
  
   var cell_feature = { "type": "Feature",
            "geometry":   {"type": "Polygon","coordinates": cell_coords},
            "properties": {"featureName": "cell_boundary", "path": selectedPath, "row": selectedRow}
                 }
   return JSON.stringify(cell_feature);
};


function cellSelected()
{
// Fetch Outline and statuds of this Landsat Cell

  var httpget_url = "/selectcell/" + jsonStringifySelectedCell()
  console.log( "cellSelected() %d %d %s", selectedPath, selectedRow, httpget_url);
   
  $("#observations_panel").collapse('show');
       $('#observations_panel').empty();
       $('#observations_panel').append("SelectCell...");
       $('#observations_panel').append('<img src="/static/img/ajax-loader.gif" class="ajax-loader"/>');
       $.get(httpget_url).done(function(data) {
              $('#observations_panel').empty();
              
              
              var panel_str = "Cell:"          
              var celldict = jQuery.parseJSON(data);
              console.log(celldict)
              if (celldict['result'] == "ok") {         	  	                          
	              if (celldict.monitored == "true") 
	                  {
	            	    panel_str = "Now Monitoring Cell(" + celldict.path  + ", " +  celldict.row + ")<br>Last Obs: " + celldict.LC8_latest_capture;
	            	    console.log( "Following: " + celldict.path  + ", " +  celldict.row)
	                    monitor_cell(selectedPath, selectedRow, true);
	                  }
	              else
	                  {
                         panel_str = "Stopped Monitoring Cell(" + celldict.path  + ", " +  celldict.row + ") ";
	            	     console.log( "Stopped Monitoring: " + celldict.path  +", " +  celldict.row)
	                     monitor_cell(selectedPath, selectedRow, false);
	                  }
	              $('#observations_panel').append(panel_str);  
               }
               else {
                   console.log( "Error: " + celldict['result']);
               }             
        }).error(function( jqxhr, textStatus, error ) {
            var err = textStatus + ', ' + error;
            console.log( "Request Failed: " + err);
            $('#observations_panel').empty();
            $('#observations_panel').append("<p>Failed: " + err + "</p>"); 
     });
}



</script>

{% endblock %} {% block content %}
<div class="container" >
	<ul class="breadcrumb">
		<li><a href="{{ "user"|url(username) }}">{{ username }}</a> <span class="divider">/</span></li>
		<li class="active"><a href="{{ area|area_url }}">{{ area }}</a></li>
	</ul>
</div>



<div style="padding:0 15px;">
	<div class="row">
		<div class="col-md-2">
			<!--Sidebar content <div class="control-group"> -->
			<!-- Algorithm Selection button -->
			<div class="btn-toolbar" style="margin: 0;">
				<h5>
					<i>View Image Settings</i>
				</h5>

				<div class="controls">
					<input id="instructions" type="button" class="btn btn-lightblue" style="width: 180px" rel="popover" value="Instructions" />
				</div>
				<div class="btn-toolbar" role="toolbar">
					<div class="btn-group">
						<button id='algorithm' type="button" style="width: 50px" class="btn btn-xs dropdown-toggle" data-toggle="dropdown"
							data-toggle="tooltip" title="Select RGB for true colour or NDVI to highlight vegetation change">
							RGB<span class="caret"></span>
						</button>
						<ul class="dropdown-menu" role="menu">
							<li><a href="#" id='algorithm-visual'>RGB</a></li>
							<li class="divider"></li>
							<li><a href="#" id='algorithm-ndvi'>NDVI</a></li>
							<li><a href="#" id='algorithm-change'>Change</a></li>
						</ul>
					</div>
					<div class="btn-group">
						<button id='latest' type="button" style="width: 60px" class="btn btn-xs dropdown-toggle" data-toggle="dropdown"
							data-toggle="tooltip" title="Select the latest image, the one before or the one before that)">
							Latest<span class="caret"></span>
						</button>
						<ul class="dropdown-menu" role="menu">
							<li><a href="#" id='latest'>Latest</a></li>
							<li class="divider"></li>
							<li><a href="#" id='latest-1'>Latest-1</a></li>
							<li><a href="#" id='latest-2'>Latest-2</a></li>
							<li><a href="#" id='latest-3'>Latest-3</a></li>
						</ul>
					</div>
					<div class="btn-group">
						<button id='satellite' type="button" style="width: 40px" class="btn btn-xs dropdown-toggle" data-toggle="dropdown"
							data-toggle="tooltip" title="Select Landsat7, Landsat 8)">
							L8<span class="caret"></span>
						</button>
						<ul class="dropdown-menu" role="menu">
							<li><a href="#" id='satellite-l7'>L7</a></li>
							<li class="divider"></li>
							<li><a href="#" id='satellite-both'></a></li>
						</ul>
					</div>
				</div>
			</div>
			<div class="btn-toolbar" style="margin: 0;">
				<div class="btn-group">
					<button id='get_overlay_btn' type="button" style="width: 43px" class="btn btn-xs btn-lightblue" data-toggle="tooltip"
						title="Overlay selected image on the map">View</button>
				</div>
				<div class="btn-group">
					<button id='get_download_btn' type="button" style="width: 65px" class="btn btn-xs btn-lightgreen" data-toggle="tooltip"
						title="Download selected image to a (very large) file">Download</button>
				</div>
				<div class="btn-group">
					<button id='get_add_btn' type="button" style="width: 43px" class="btn btn-xs btn-lightblue" data-toggle="tooltip"
						title="Add selected cell to observation schedule">Add</button>
				</div>

			</div>
			<div>
				<p>
					<input type="checkbox" id="0" class="layer" checked data-toggle="tooltip" title="Show grid cells of landsat image boundaries" /><label for="0">Landsat Grid </label> 
					<input type="checkbox" id="1" class="layer" unchecked data-toggle="tooltip" title="Report a change or disturbance" /><label for=1">Make Report </label>
                    <input type="checkbox" id="2" class="layer" unchecked data-toggle="tooltip" title="Show FORMA estimate of recent tree loss" /><label for=2">FORMA</label>
			</div>
			<div class="accordion" id="accordion2">
                </div>
                    <div class="accordion-group">
                    <div class="accordion-heading">
                        <a class="accordion-toggle" data-toggle="collapse" href="#layers_panel"> Layers </a>
                    </div>
                    <div id="layers_panel" class="accordion-body collapse in">
                        <div class="accordion-inner">
                        <ul id="sliders_array">
                               <div class="slider"></div>
                        </ul>
                        </div>
                    </div>
                </div>

				<div class="accordion-group">
					<div class="accordion-heading">
						<a class="accordion-toggle" data-toggle="collapse" href="#description_panel"> Area Description </a>
					</div>
					<div id="description_panel" class="accordion-body collapse in">
						<div class="accordion-inner">
							<p>{{ area.description }}</p>
						</div>
					</div>
				</div>
				<div class="accordion-group">
					<div class="accordion-heading">
						<a class="accordion-toggle" data-toggle="collapse" href="#observations_panel"> Observations </a>
					</div>
					<div id="observations_panel" class="accordion-body collapse">
						<div class="accordion-inner">
							<p>No Observations.
							<p>
						</div>
					</div>
				</div>
				<div class="accordion-group">
					<div class="accordion-heading">
						<a class="accordion-toggle" data-toggle="collapse" href="#reports_panel"> Reports </a>
					</div>
					<div id="reports_panel" class="accordion-body collapse">
						<div class="accordion-inner">
							<p>No reports
							<p>
						</div>
					</div>
				<div class="accordion-group">
					<div class="accordion-heading">
						<a class="accordion-toggle" data-toggle="collapse" href="#boundary_panel"> Boundary Coordinates </a>
					</div>
					<div id="boundary_panel" class="accordion-body collapse">
						<div class="accordion-inner">
							{% for j in area.coordinates %}
							<p class="divider">{{j}}</p>
							{% endfor %}
						</div>
					</div>
				</div>
				<div class="accordion-group">
					<div class="accordion-heading">
						<a class="accordion-toggle" data-toggle="collapse" href="#map_panel"> Map View </a>
					</div>
					<div id="map_panel" class="accordion-body collapse">
						<div class="accordion-inner">
							<p class="divider">"Map initial view (saved)"</p>
							<p class="divider">"Center: {{area.map_center}}"</p>
							<p class="divider">"Zoom: {{area.map_zoom}}"</p>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-md-10">
			<!--Body = Map content-->

			<div id="map-canvas"></div>
		</div>
	</div>
</div>
{% endblock %}

{% extends "base.html" %}

<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />

{% block head %}
<title>Bunjil Forest Watch - New Area</title>

<link rel="stylesheet" href="/static/css/drawing-tools.css">
<link rel="stylesheet" href="/static/css/codemirror.css">
<link rel="stylesheet" href="/static/css/simplescrollbars.css">
<link rel="stylesheet" href="/static/css/lint.css">
<link rel="stylesheet" href="/static/css/new-area.css">
<link rel="stylesheet" href="/static/css/area-description.css">

<script type="text/javascript">
	var single_map = true;
	var view_mode = "view-area";
	var initial_dragger = "100%";
</script>


{% endblock %} {% block map_head %} {% endblock map_head %} {% block content %}



<!-- NO BREADCRUMBS REQUIRED FOR THIS PAGE -->

<div id='area_json' class='django-template'>{{ area_json}}</div>
<div id='celllist' class='django-template'>{{ celllist }}</div>
<div id='latlng' class='django-template'>{{ latlng}}</div>
<div id='user_name' class='django-template'>{{ user.name }}</div>
<div id='user_url' class='django-template'>{{ "user"|url(user.name) }}</div>

<div class="space-above-form"></div>

<div class="container">
	<div class="form-horizontal" id="new_area_form">
		<!-- Form Name -->

	   <div id='register-area-legend'>
	    	<div class='form-legend'>
				Register your forest area
				<!-- <span class="glyphicon glyphicon-question-sign" ></span> -->
			</div>
	
			<div class='framing-help'>
				If you live or work near a forest and want to protect it then register it for monitoring.<br>
			</div>
	
			<div class='framing-sub-help'>
				Volunteers don't have to register a forest. They can <a href='/'>help others monitor their forests</a>.
			</div>
        </div>
        
		<div class="row">

			<div class="panel-group" id="options-accordion">

				<div class="panel-heading" id="areanameAccord_title">
					<h4 class="panel-title" data-toggle="collapse" data-parent="#options-accordion" data-target="#areanameAccord">Area
						Name</h4>
				</div>

				<div class="panel-collapse collapse in" id="areanameAccord">
					<div class="panel-body">
						<div class="form-group">

							<label class="col-md-4 control-label" for="area_name"><span class='asterix' data-toggle="tooltip"
								title='This field is required'>*</span> Area Name</label>

							<div class="col-md-4">
								<input accesskey="n" autofocus class="form-control input-md" id="area_name" name="area_name"
									placeholder="Give your area a short name" tabindex="1" type="text"> <span class="help-block">Enter a
									short unique name</span>
							</div>
						</div>
					</div>
				</div>
				<div class='validation' id='area-name-validation'>Give your area a short name.</div>

                <!-- 
				<div class="controls">
					<input id="geojson_toserver" name="geojson_toserver" type="hidden" value="undefined">
				</div>
                -->
				<!-- SHARING OPTIONS -->
				<div>

					<div class="panel-heading" id="sharingAccord_title">
						<h4 class="panel-title" data-toggle="collapse" data-parent="#options-accordion" data-target="#sharingAccord">Sharing
							Options</h4>
					</div>

					<div class="panel-collapse collapse in" id="sharingAccord">
						<div class="panel-body">
							<div class="form-group">
								<label class="col-md-4 control-label" for="opt-sharing"> <span class='asterix' title="This field is required">*</span>
									Shared or Private?
								</label>

								<div class="col-md-6">
									<div class="radio" id='private'>
										<label for="private"><input accesskey="r" name="opt-sharing" tabindex="2" type="radio" value="private">
											Private</label>
									</div>
									<span class="help-block">Only you can see and monitor this area. Volunteers can't see it and won't be able to
										help you monitor. See <a href="http://bunjilforestwatch.net/privacy">Privacy</a>
									</span>

									<div class="radio" id='unlisted'>
										<label for="unlisted"><input accesskey="u" name="opt-sharing" tabindex="3" type="radio" value="unlisted">
											Unlisted</label>
									</div>
									<span class="help-block">Only people with the link can see or follow this area</span>

									<div class="radio" id='public'>
										<label for="public"><input accesskey="p" name="opt-sharing" tabindex="4" type="radio" value="shared">
											Shared</label>
									</div>
									<span class="help-block">Everyone can see and follow this area.</span>

								</div>
							</div>
						</div>
					</div>

					<div class='validation' id='sharing-validation'>Choose private, unlisted or shared. shared allows volunteers to help
						you monitor.</div>

				</div>

				<!--  Monitoring Options Accordion -->


				<div class="panel-heading" id='monitoringAccord_title'>
					<h4 class="panel-title" data-toggle="collapse" data-parent="#options-accordion" data-target="#monitoringAccord">Monitoring
						Options</h4>
				</div>

				<div class="panel-collapse collapse in" id="monitoringAccord">
					<div class="panel-body">


						<div class="form-group">
							<label class="col-md-4 control-label" id="opt-monitoring">Monitoring Options</label>

							<div class="col-md-6">

								<div class="checkbox">
									<label class="checkbox-inline" for="self-monitors"><input accesskey="m" id='self-monitor' name="self-monitor"
										tabindex="5" type="checkbox" checked='checked' value="true"> Self Monitor</label><span class="help-block">Notify
										me when there are new images of my area. I have time and bandwidth to review images.</span>
								</div>



								<div class="checkbox">
									<label class="checkbox-inline" for="request-volunteers"><input accesskey="v" id='request-volunteers'
										name="request-volunteers" tabindex="6" type="checkbox" checked='checked' value="true"> Community monitoring</label><span
										class="help-block">Ask Volunteers to help monitor my area. I don't have the ability to monitor images for
										changes.</span>
								</div>

							</div>
						</div>
					</div>
					<div class='validation' id='monitoring-validation'>Either self-monitor or request volunteers.</div>
				</div>

				<!-- Agreement Undertaking -->
				<div class="panel-heading" id="agreementAccord_title">
					<h4 class="panel-title" data-toggle="collapse" data-parent="#options-accordion" data-target="#agreementAccord">Agree
						to Monitor</h4>
				</div>

				<div class="panel-collapse collapse in" id="agreementAccord">
					<div class="panel-body">
						<div class="form-group">
							<label class="col-md-4 control-label" for="accept"><span class='asterix'
								title="You must agree to investigate disturbances to request volunteers">*</span>I Accept</label>

							<div class="col-md-6">
								<label class="checkbox-inline" for="accept"><input accesskey="" id="accept" name="accept" tabindex="7"
									type="checkbox" value="true"> I agree to check distrubance reports created by volunteers for this area</label>
							</div>
						</div>
					</div>

				</div>
				<div class='validation' id='accept-validation'>To register an area you must agree to investigate reports in your area.
				</div>

				<hr>

			</div>
			
			<!-- NEXT -->
			<div class="form-group" id='next-subform'>
				<div class='col-md-4'></div>
				<div class='col-md-5'>
					<button accesskey="x" class="btn btn-default btn-form-ctrl" id="next-area" name="next-area" tabindex="8">Next</button>
				</div>

				<div class="col-md-8">
					<div class="help-block" id='form-errors'></div>
				</div>
			</div>

		</div>
		
	    <!--  DESCRIPTION  -->
        <div class='row' id='description-form' style='display:none'>
        
            <div class="panel-group">
                <div class="panel-heading">
                    <h4 class="panel-title" data-toggle="collapse" data-parent="#options-accordion" data-target="#descriptionAccord">Describe
                        your area</h4>
                </div>

                <div class="panel-collapse collapse" id="descriptionAccord">

                     <div class='form-legend'>
                            Update area's description 
                    </div>
    
                    <div class="panel-title framing-help" data-target="#add-a-description-legend">Tell others why you are monitoring it. </div>
                    <div class="panel-title framing-sub-help">
                        You can skip this step and update the description later.
                    </div>
        
                    <div class="form-group" >
                        <div class='col-md-1'></div>
                        <div class='col-md-3'>
                                  <button  class="btn btn-sm btn-default  btn-form-ctrl" id="skip-description" data-toggle="collapse" data-parent="#options-accordion"
                                    data-target="#descriptionAccord" accesskey="k" >Skip</button>
                        </div>
                    </div>
                     <!--  INNER ACCORDION -->   
                    {% include "includes/area-description.html" %}

                </div>

            </div>
        </div>
        
		<div class="row" id='scroll-to-here' style='display: none'></div>
		<div class="row" id='map-find' style='display: none'>

			<!-- Help Locate your Area -->
			<div class="panel-group" id="locate-accordion">
				<!-- Help Locate accordion -->

				<div class="panel-heading">
					<h4 class="panel-title" data-toggle="collapse" data-parent="#locate-accordion" data-target="#helplocateAccord">Find
						your area</h4>
				</div>

				<!-- panel body -->
				<div class="panel-collapse collapse in" id="helplocateAccord">
					<div class="panel-body">
						<div class='form-legend'>Locate your Area</div>

						<div id='subform-find-help'>
							<div class="row">
								<div class="col-md-1"></div>

								<div class='col-md-6 framing-help  subform-control-label'>Need help finding your area?</div>

								<div class="col-md-5"></div>
							</div>

							<div class="row">

								<div class="col-md-1"></div>

								<div class="col-md-3 form-group">
									<label class="control-label">My Forest is here</label>
									<button class="btn btn-default" id="zoom-here" name="zoom-here">Use My Location</button>

									<p class="help-block" id='zoom-here-help'>Click if your forest is near you now.</p>
								</div>

								<div class="col-md-7 form-group">
									<label class="control-label" for='searchbox_id'>Find by name</label> <input class="form-control input-md"
										id="searchbox_id" name="searchinput" placeholder="Enter name of a place near your area" type="text">

									<p class="help-block">Map will zoom to that place</p>
								</div>

								<div class="col-md-1"></div>
							</div>
						</div>
					</div>
				</div>

				<div id='drawlocateAccord_c'>

					<!-- Draw Location Accordion -->
					<div class="panel-heading">
						<h4 class="panel-title" data-toggle="collapse" data-parent="#locate-accordion" data-target="#drawlocateAccord">Mark
							your area on the map</h4>
					</div>

					<div class="panel-collapse collapse in" id="drawlocateAccord">
						<div class="panel-body">
							<!-- DRAWING MODE BUTTONS -->


							<div class="row">
								<!--  LANDSAT GRID -->


								<div class='col-md-1'>
									<input checked id="landsat-grid" type="checkbox" value='true'> <label><span
										class="glyphicon glyphicon-th" data-toggle="tooltip" style='color: #234196'
										title="Show grid of the shape of Landsat images"></span></label>
								</div>

								<div class="col-md-6">
									<label class="subform-control-label">Mark your area on the map</label>
								</div>


								<div class="col-md-5"></div>
							</div>
							<!-- MOVE DRAG THEN PLACE-MARK -->

							<div class="row" id='drag-map-form'>
								<div class="col-md-1"></div>


								<div class="col-md-2 form-group">
									<button class="btn btn-primary" data-placement="top" data-target='#zoom-more-popover' data-toggle="popover-x"
										id="drop-pin-mode" name="drop-pin">
										Place mark <span class="glyphicon glyphicon glyphicon-map-marker" style='color: #FA7063'></span>
									</button>

									<div class='popover popover-info' data-toggle="popover-x" id="zoom-more-popover">
										<div class="arrow"></div>


										<h3 class="popover-title">Zoom in closer!</h3>


										<div class="popover-content">
											To place a mark accurately you must zoom in more.<br> <b>Double Click</b> near your area on the map to zoom in
											more.<br> Or use the zoom slider on the left side of the map.
										</div>


										<div class="popover-footer">
											<button class="btn btn-sm btn-info" id='zoom-more-popover-close'>Close</button>
										</div>
									</div>
								</div>


								<div class="col-md-7 form-group">
									<label class="control-label" id='move-map-label' style='text-align: left'><a class="popup"
										data-placement="bottom" data-target='#zoom-help-popover' data-toggle="popover-x" data-trigger='hover click'
										id="zoom-help">Zoom</a> and <a class="popup" data-target='#drag-help-popover' data-toggle="popover-x"
										data-trigger='hover click' id="drag-help">Drag</a> the map so it shows your area. Then click <i>Place Mark</i></label>

									<div class='popover popover-info' id="zoom-help-popover">
										<div class="arrow"></div>


										<h3 class="popover-title">Zooming</h3>


										<div class="popover-content">
											To zoom in more <b>Double Click</b> near your area on the map.<br> Or use the zoom slider on the left side of
											the map.
										</div>


										<div class="popover-footer">
											<button class="btn btn-sm btn-info" id='zoom-help-popover-close'>Close</button>
										</div>
									</div>


									<div class='popover popover-info' id="drag-help-popover">
										<div class="arrow"></div>


										<h3 class="popover-title">Moving the Map</h3>


										<div class="popover-content">
											To drag the map <b>Click and Hold</b> the mouse over the map.<br> Or use the arrows on the top left corner of
											the map.
										</div>


										<div class="popover-footer">
											<button class="btn btn-sm btn-info" id='drag-help-popover-close'>Close</button>
										</div>
									</div>
								</div>
							</div>


							<div class="row">
								<div class='col-md-1'></div>
								<!-- MARKING-MAP-->


								<div id="mark-map-form">
									<div class="col-md-7 form-group">
										<label class="control-label">Click on the map over your area to mark where it is.</label>
									</div>
								</div>
								<!-- SAVING-AREA-->


								<div id="save-area-form">
									<div class='col-md-2'>
										<button class="btn btn-primary" id="save-area" name="move-map">
											Save <span class="glyphicon glyphicon glyphicon-save" style='color: #FA7063'></span>
										</button>

										<div class='popover popover-info popover-md' data-placement='right' data-target='#save-wait-popover1'
											data-toggle="popover-x" id="save-wait-popover" style='display: none'>
											<div class="arrow" id='save-wait-popover1'></div>

											<h3 class="popover-title">Saving Area</h3>

											<div class="popover-content">
												Saving your area now.<br /> <img src='/static/img/ajax-loader.gif' class='ajax-loader' alt="" />
											</div>

											<div class="popover-footer">
												<button class="btn btn-sm btn-default" id='close-dialog-save-area-wait'>OK</button>
											</div>
										</div>
									</div>

									<div class="col-md-5 form-group">
										<label class="control-label">If mark is over your area click <i>Save area</i></label>
									</div>
								</div>
							</div>
							<!-- MOVE MAP LINK -->


							<div class="form-group" id='move-map-form'>
								<div class="col-md-1">
									<button class="btn btn-small" data-toggle="tooltip" id="move-map-mode" name="move-map-mode"
										title="Reposition the map view">
										Drag Map<span class="glyphicon glyphicon glyphicon-hand-up" style='color: #FA7063'></span>
									</button>
								</div>


								<div class="col-md-1"></div>


								<div class="col-md-1">
									<button class="btn btn-small" data-toggle="tooltip" id="clear-map" name="clear-map" title="Clear all marks on the map">
										Clear <span class="glyphicon glyphicon glyphicon-erase" style='color: #FA7063'></span>
									</button>
								</div>


								<div class="col-md-1">
									<img alt="Advanced" id='advanced' src="/static/img/gear-icon.png" style="width: 20px; height: 20px">
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>



		<!--  DEFINE AREA - BOUNDARY SELECTION  -->
		
		<div  class="row" id='boundary-row' style='display: block'>

            <!-- BOUNDARY OPTIONS -->
                <div>

                    <div class="panel-heading" id="boundaryAccord_title">
                        <h4 class="panel-title" data-toggle="collapse" data-parent="#bounadary-accordion" data-target="#boundaryAccord">Area Boundary</h4>
                    </div>

                    <div class="panel-collapse collapse in" id="boundaryAccord">
	                    <div class='form-legend'>
	                        Area boundary
	                    </div>
	    
	                    <div class='framing-help'>
	                        You can draw the boundary of your area now, or enter it from another source.<br>
	                    </div>
	    
	                    <div class='framing-sub-help'>
	                       The boundary defines the size and shape of the area to select the best images and to help observers. <br/>
	                       It is highly recommended to define a boundary for your area - even an approximate one.
	                    </div>
	                
                        <div class="panel-body">
                            <div class="form-group">
                                <label class="col-md-4 control-label" for="opt-boundary">
                                    Boundary Input
                                </label>

                                <div class="col-md-6">
                                    <div class="radio" id='private'>
                                        <label for="private"><input accesskey="d" name="opt-boundary" type="radio" value="is-drawmap">
                                            Draw boundary</label>
                                    </div>
                                    <span class="help-block">Draw a shape around your area on the map.</span>

                                    <div class="radio" id='public'>
                                        <label for="public"><input accesskey="g" name="opt-boundary" type="radio" value="is-geojson">
                                            GeoJSON file</label>
                                    </div>
                                    <span class="help-block">Import boundary from a <a href="http://geojson.org">GeoJSON</a> file.</span>
                                
	                                <div class="radio" id='unlisted'>
	                                        <label for="unlisted"><input accesskey="f" name="opt-boundary" type="radio" value="is-fusion">
	                                            Fusion Table</label>
	                                 </div>
	                                 <span class="help-block">Import  boundary from a <a href="http://tables.googlelabs.com">fusion table</a></span>
                                </div>
                                
                            </div>
                        </div>
                        <hr>
                        
                        <div class="panel-collapse collapse in" id="draw-bdry-ctrl-panel">
                                <div class='col-md-1'></div>
                                <div class='col-md-10'>
			                        <label class="control-label" id='move-map-label' style='text-align: left'><a class="popup"
		                                        data-placement="bottom" data-target='#zoom-help-popover' data-toggle="popover-x" data-trigger='hover click'
		                                        id="zoom-help">Zoom</a> and <a class="popup" data-target='#drag-help-popover' data-toggle="popover-x"
		                                        data-trigger='hover click' id="drag-help">Drag</a> the map so it shows your area. Then click <i>Draw Boundary</i><br/>
		                             </label>
                                </div>	        
                                <div class='col-md-1'></div>
	                        <div class="form-group" >
		                        <div class='col-md-1'></div>
		                        <div class='col-md-10'>
		                                  <button  class="btn btn-primary btn-form-ctrl" id="start-drawing" accesskey="d" ><b>Draw Boundary</b></button>
		                        </div>
	                        </div>
                        </div>
                        <hr>
                        
                        <div class="panel-collapse collapse in " id="drop-geojson-bdry-ctrl-panel">
                            <div class="panel-title framing-help" id='geojson-instr'>Drop your GeoJSON file directly onto the map</div>
                        </div>
                        <hr>
                        <div class="panel-collapse collapse in" id="fusion-table-ctrl-panel">
                            <div class="panel-title framing-help" id='fusion-instr'>Fusion Table Id</div>
                            <div class="panel-title framing-sub-help" id='fusion-sub-instr'>
                                        The fusion table must be public to be imported by this app.<br/>
                                        Copy <b>Id</b> from table in your Google Drive. Displayed in File-About. 
                                        Only the outer boundary will be imported.<br/>
                            </div>
                            <div class="form-group">

	                            <label class="col-md-4 control-label" for="fusion_id">Fusion Table Id</label>
	
	                            <div class="col-md-4">
	                                <input accesskey="f" autofocus class="form-control input-md" id="fusion_id" name="fusion_id"
	                                    placeholder=""  type="text"> <span class="help-block">Enter the key or id</span>
	                            </div>
                            </div>
                    
'                        </div>
                        <hr>
                    
                        <div class="panel-collapse collapse in" id="save-bdry-ctrl-panel">
                               <div id="save-boundary-form">
                                    <div class='col-md-6'>
                                        <button class="btn btn-primary" id="save-boundary" name="save-boundary">
                                            Save Boundary<span class="glyphicon glyphicon glyphicon-save" style='color: #FA7063'></span>
                                        </button>

                                        <div class='popover popover-info popover-md' data-placement='right' data-target='#save-boundary-wait-popover1'
                                            data-toggle="popover-x" id="save-wait-boundary-popover" style='display: none'>
                                            <div class="arrow" id='save-wait-boundary-popover1'></div>

                                            <h3 class="popover-title">Saving Boundary </h3>

                                            <div class="popover-content">
                                                Saving your boundary now.<br /> <img src='/static/img/ajax-loader.gif' class='ajax-loader' alt="" />
                                            </div>

                                            <div class="popover-footer">
                                                <button class="btn btn-sm btn-default" id='close-dialog-save-area-wait'>OK</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class='col-md-6'>
                                        <button class="btn btn-default" id="cancel-boundary" name="cancel-boundary">
                                            Cancel<span class="glyphicon glyphicon-remove-sign" style='color: #FA7063'></span>
                                        </button>

                                    </div>
                                    
                                </div>                        
                        </div>
                    </div>
                </div>
		</div> <!-- END boundary-row -->

        <!-- MAP PANEL (MAY ALSO SHOW  EDITOR)-->
		<div class="row" id='map-row' style='display: none'>
		
			<div class='col-md-12 nopadding' id='map-column'>
				<div class='map-canvas' id='map-canvas-c'>
					<div id="drop-container">
						<div id="drop-silhouette"></div>
					</div>


					<div id="map-canvas"></div>
				</div>
			</div>


			<div class='col-md-3 nopadding' id='geojson-column' style='display: none'>

				<!--  GeoJSON -->
				<div class='extended-content-container' id='geojson-editor'>
					<div id='geojson-panel'>
						<div class='help-block' id="geojson-controls">
							<div id="panel-title">Edit GeoJSON</div>
							<a class="btn btn-sm btn-default" id="select-all">Select All</a> <a class="btn btn-sm btn-default"
								download="my_area.json" href="data:;base64," id="download-link">Download<span
								class="glyphicon glyphicon glyphicon-download-alt" style='color: #FA7063'></span></a>
						</div>

						<textarea cols="" id="geojson-input" placeholder="Drag GeoJSON to map" rows="">
</textarea>
					</div>
				</div>
				
			</div>
		</div>



		<div class="control-group">
			<input class="btn btn-lightgreen map-panel-controls" id="createarea_id" style='display: none' type="button"
				value="Create Area">
		</div>


		<div class="control-group">
			<div class="controls">
				<input id="coordinates_id" name="coordinates" type="hidden" value="undefined">
			</div>


			<div class="map-panel-fusiontable" id="fusiontable-form-c" style='display: none'>
				<label class="control-label map-panel-controls" data-toggle="tooltip" for="boundary_ft"
					title="If your area's boundary is already in a fusion table, link to it here.">Fusion Table Id: <span
					style="color: #ff0000">*</span></label> <input class="map-panel-controls" id="boundary_ft" name="boundary_ft" type="text">
			</div>


			<div id="boundary-instructions" style='display: none'></div>
		</div>


		<form action=""></form>
	</div>
	<div></div>
	{% include "includes/project_scripts.html" %} {% include "includes/map_scripts.html" %}

	<script src="/static/js/vendor/codemirror.js" type="text/javascript"></script>
	<!-- geojson editor -->
	<script src="/static/js/vendor/javascript.js" type="text/javascript"></script>
	<!-- Context highlighting for json in editor -->
	<script src="/static/js/vendor/simplescrollbars.js" type="text/javascript"></script>
	<!-- for editor -->
	<script src="/static/js/vendor/placeholder.js" type="text/javascript"></script>
	<!-- for editor -->

	<script src="/static/js/vendor/lint.js" type="text/javascript"></script>
	<!-- addon for editor -->
	<script src="/static/js/vendor/geojsonhint.js" type="text/javascript"></script>
	<!-- parses geojson-->
	<script src="/static/js/vendor/jsonlint-min.js" type="text/javascript"></script>
	<!-- parses json can remove min to debug-->
	<script src="/static/js/geojson-lint.js" type="text/javascript"></script>
	<!-- addon connects lint to editor -->

	<script src="/static/js/new-area.js" type="text/javascript" defer> </script>
	<script type="text/javascript" src="/static/js/area-description.js" defer></script>
	
	{% endblock %} 
	{% block footer_js%} {% endblock footer_js %}

</div>